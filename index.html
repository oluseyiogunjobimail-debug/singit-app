<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sing It ✨</title>

<style>
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
height:100vh;
display:flex;
justify-content:center;
align-items:center;

background:
radial-gradient(circle at 20% 30%, rgba(255,0,150,0.25), transparent 40%),
radial-gradient(circle at 80% 70%, rgba(0,200,255,0.25), transparent 40%),
linear-gradient(135deg,#0f2027,#203a43,#6a11cb);

background-size:200% 200%;
animation:bgMove 15s ease infinite;
}

@keyframes bgMove{
0%{background-position:0% 50%;}
50%{background-position:100% 50%;}
100%{background-position:0% 50%;}
}

.card{
width:380px;
padding:40px;
border-radius:20px;
background:rgba(255,255,255,0.06);
backdrop-filter:blur(20px);
box-shadow:0 0 40px rgba(0,0,0,0.4);
text-align:center;
animation:fadeIn 0.8s ease;
}

@keyframes fadeIn{
from{opacity:0;transform:translateY(15px);}
to{opacity:1;transform:translateY(0);}
}

h1{color:white;margin-bottom:10px;}
.subtitle{color:rgba(255,255,255,0.7);margin-bottom:25px;font-size:14px;}

input{
width:100%;
padding:14px;
margin-top:10px;
border:none;
border-radius:10px;
background:rgba(255,255,255,0.15);
color:white;
outline:none;
}

input::placeholder{
color:rgba(255,255,255,0.6);
}

button{
margin-top:20px;
width:70%;
padding:14px;
border:none;
border-radius:12px;
font-size:16px;
font-weight:bold;
color:white;
cursor:pointer;
background:linear-gradient(90deg,#ff00cc,#3333ff);
transition:0.3s;
}

button:disabled{
opacity:0.6;
cursor:not-allowed;
}

button:hover:not(:disabled){
transform:scale(1.05);
box-shadow:0 0 20px rgba(255,0,200,0.5);
}

#loading{
margin-top:15px;
color:white;
display:none;
}

#success{
margin-top:10px;
color:#00ffcc;
display:none;
}

audio{
margin-top:20px;
width:100%;
display:none;
}

#downloadBtn{
margin-top:15px;
display:none;
width:60%;
padding:10px;
border-radius:10px;
border:none;
background:linear-gradient(90deg,#00c6ff,#0072ff);
color:white;
font-weight:bold;
cursor:pointer;
}

</style>
</head>
<body>

<div class="card">

<h1>Sing It ✨</h1>
<div class="subtitle">Create Nigerian AI songs with your name</div>

<input id="name" placeholder="Your name">
<input id="prompt" placeholder="Afrobeats, birthday, love...">

<button id="createBtn" onclick="createSong()">Create Song</button>

<div id="loading">Creating your song...</div>
<div id="success">Song created successfully</div>

<audio id="player" controls></audio>
<button id="downloadBtn">Download Song</button>

</div>

<script>

async function createSong(){

const name=document.getElementById("name").value.trim();
const prompt=document.getElementById("prompt").value.trim();

const btn=document.getElementById("createBtn");
const loading=document.getElementById("loading");
const player=document.getElementById("player");
const success=document.getElementById("success");
const downloadBtn=document.getElementById("downloadBtn");

if(!name || !prompt){
alert("Please enter your name and song style");
return;
}

btn.disabled=true;
loading.style.display="block";
success.style.display="none";
player.style.display="none";
downloadBtn.style.display="none";

try{

const res=await fetch("/api/generate-song",{
method:"POST",
headers:{ "Content-Type":"application/json" },
body:JSON.stringify({ name, prompt })
});

if(!res.ok){
const text=await res.text();
alert("Error: "+text);
btn.disabled=false;
loading.style.display="none";
return;
}

const blob=await res.blob();
const url=URL.createObjectURL(blob);

player.src=url;
player.style.display="block";
player.play();

downloadBtn.style.display="inline-block";
downloadBtn.onclick=function(){
const a=document.createElement("a");
a.href=url;
a.download=name+"-song.mp3";
a.click();
};

success.style.display="block";

}catch(err){
alert("Something went wrong");
}

loading.style.display="none";
btn.disabled=false;

}

</script>

</body>
</html>
